import{r as w,o as i,c,a as g,b as C,d as f,w as O,e as x,f as b,g as I,F as k,h as $,i as u,u as p,t as y,j as M,k as S,l as h,m as L,n as A,p as N,q as P}from"./vendor.8dfcf02a.js";const B=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerpolicy&&(o.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?o.credentials="include":e.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(e){if(e.ep)return;e.ep=!0;const o=n(e);fetch(e.href,o)}};B();var _=(s,t)=>{const n=s.__vccOpts||s;for(const[r,e]of t)n[r]=e;return n};const R={},j={id:"container"};function q(s,t){const n=w("router-view");return i(),c("div",j,[g(n)])}var z=_(R,[["render",q]]);const F="336533c962dc13751bb135b2b063c86d",H=C.create({baseURL:"https://api.themoviedb.org/3",withCredentials:!1,headers:{Accept:"application/json","Content-Type":"application/json"}});var E={getNowPlayingMovie(s){return H.get(`/movie/now_playing?api_key=${F}&language=zh-TW&page=${s}`)}};const T=s=>E.getNowPlayingMovie(s).then(t=>t.data).catch(t=>{throw t});const V={ref:"infinityContainer"},D={props:{observerCallback:{type:Function,required:!0},unbindObserver:{type:Boolean,required:!0},observerOption:{type:Object}},setup(s){const t=s,n=f(null);let r;return O(()=>t.unbindObserver,e=>{!e||r.unobserve(n.value)}),x(()=>{const e=t.observerOption&&{root:null,rootMargin:"0px 0px -1000px 0px",threshold:-1};r=new IntersectionObserver(t.observerCallback,e),r.observe(n.value)}),(e,o)=>(i(),c("div",V,[b(e.$slots,"default",{},void 0,!0),s.unbindObserver?I("",!0):(i(),c("div",{key:0,ref_key:"infinityObserver",ref:n},[b(e.$slots,"observer",{},void 0,!0)],512))],512))}};var K=_(D,[["__scopeId","data-v-34d39998"]]);const W={},U={class:"text-center text-4xl font-bold"};function Y(s,t){return i(),c("div",U,"loading...")}var G=_(W,[["render",Y],["__scopeId","data-v-10375cae"]]);const J=["data-src","alt"],Q={props:{imageSRC:{type:String,required:!0},alt:{type:String}},setup(s){const t=f(null);x(()=>{new IntersectionObserver(n,{root:null,rootMargin:"0px 0px 0px 0px",threshold:0}).observe(t.value)});function n([r],e){if(!r||!r.isIntersecting)return;const o=r.target,a=o.getAttribute("data-src");a&&(o.src=a),e.unobserve(o)}return(r,e)=>(i(),c("img",{ref_key:"lazyImage",ref:t,"data-src":s.imageSRC,alt:s.alt},null,8,J))}};var X=_(Q,[["__scopeId","data-v-f05f4c92"]]);const Z={class:"flex justify-start items-start flex-wrap m-auto max-w-screen-md"},ee={class:"movie-poster"},te={class:"flex justify-start items-stretch text-2xl px-3 py-4 text-white"},re={class:"flex-1 w-full"},oe={class:"movie-title"},se={class:"mt-1 text-gray-400"},ne={class:"movie-vote"},ae={props:{movies:{type:Array,required:!0}},setup(s){return(t,n)=>(i(),c("ul",Z,[(i(!0),c(k,null,$(s.movies,({title:r,id:e,poster_path:o,release_date:a,vote_average:d})=>(i(),c("li",{key:e,class:"movie-item"},[u("div",ee,[g(p(X),{imageSRC:`https://image.tmdb.org/t/p/w300_and_h450_bestv2${o}`,alt:r},null,8,["imageSRC","alt"])]),u("div",te,[u("div",re,[u("p",oe,y(r),1),u("p",se,y(a),1)]),u("div",ne,[u("span",null,y(d),1)])])]))),128))]))}};var ie=_(ae,[["__scopeId","data-v-36900d79"]]);const ce={setup(s){const t=f([]),n=f(0),r=f(null),e=M(()=>n.value===r.value);async function o([d]){if(!!d.isIntersecting&&!e.value)try{n.value+=1;const l=await T(n.value);r.value=l.total_page,t.value=a(l.results)}catch(l){console.log(l)}}function a(d){const l=[...t.value,...d.filter(v=>v.poster_path)].reduce((v,m)=>[...v,[m.id,m]],[]);return[...new Map(l)].reduce((v,m)=>[...v,m[1]],[])}return(d,l)=>(i(),S(p(K),{observerCallback:o,unbindObserver:p(e)},{observer:h(()=>[g(p(G))]),default:h(()=>[g(p(ie),{movies:t.value},null,8,["movies"])]),_:1},8,["unbindObserver"]))}};var le=_(ce,[["__scopeId","data-v-01beed30"]]);const ue=[{path:"/",name:"home",component:le}],de=L({history:A("/intersection-observer-practice/"),routes:ue,scrollBehavior(s,t,n){return n||{top:0}}});var _e=N({modules:{},state:{},getters:{},mutations:{},actions:{}});P(z).use(de).use(_e).mount("#app");
